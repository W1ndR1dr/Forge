{
  "version": "1.0.0",
  "features": {
    "wave0-enhanced-init": {
      "id": "wave0-enhanced-init",
      "title": "Enhanced Init",
      "description": "Scan codebase, ask vision questions, generate project-context.md",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T12:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T12:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 0 - init.py with codebase scanning",
      "tags": [
        "wave0",
        "cli",
        "foundation"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave0-backend-crud": {
      "id": "wave0-backend-crud",
      "title": "Backend Edit/Delete Endpoints",
      "description": "PATCH and DELETE endpoints for features in server.py",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T12:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T12:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 0 - Full CRUD in server.py",
      "tags": [
        "wave0",
        "backend",
        "foundation"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave0-prompt-template-v2": {
      "id": "wave0-prompt-template-v2",
      "title": "Prompt Template v2",
      "description": "Expert consultation + research patterns in prompt_builder.py",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T12:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T12:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 0 - Rich prompts with expert patterns",
      "tags": [
        "wave0",
        "prompts",
        "foundation"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-brainstorm-mode": {
      "id": "wave1-brainstorm-mode",
      "title": "Brainstorm Mode",
      "description": "Claude chat with product strategist system prompt, outputs READY_FOR_APPROVAL JSON",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T17:30:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T17:30:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - brainstorm.py with CLI integration",
      "tags": [
        "wave1",
        "cli",
        "claude"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-proposal-parser": {
      "id": "wave1-proposal-parser",
      "title": "Proposal Parser",
      "description": "Parse READY_FOR_APPROVAL JSON from Claude output",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T17:30:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T17:30:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - Parser in brainstorm.py + AppState.swift",
      "tags": [
        "wave1",
        "parser"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-approve-decline-defer-ui": {
      "id": "wave1-approve-decline-defer-ui",
      "title": "Approve/Decline/Defer UI",
      "description": "SwiftUI views for reviewing brainstorm proposals before adding to registry",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T20:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T20:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - ProposalReviewView.swift, ProposalCard.swift",
      "tags": [
        "wave1",
        "swiftui",
        "gui"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-copy-prompt": {
      "id": "wave1-copy-prompt",
      "title": "Copy Prompt to Clipboard",
      "description": "One-click copy of generated implementation prompt from FeatureCard",
      "status": "completed",
      "priority": 1,
      "complexity": "small",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T18:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T18:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - Core workflow feature",
      "tags": [
        "wave1",
        "clipboard",
        "workflow"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-feature-editing": {
      "id": "wave1-feature-editing",
      "title": "Feature Editing in GUI",
      "description": "Edit features directly in SwiftUI app, not just CLI",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T18:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T18:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - FeatureEditSheet.swift",
      "tags": [
        "wave1",
        "swiftui",
        "gui"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave1-macos-app-core": {
      "id": "wave1-macos-app-core",
      "title": "macOS App Core",
      "description": "XcodeGen project, data models, Kanban view, feature cards, sidebar navigation",
      "status": "completed",
      "priority": 1,
      "complexity": "large",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T15:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T15:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 1 - Full macOS app with KanbanView, FeatureCard, ProjectListView, AppState, APIClient",
      "tags": [
        "wave1",
        "macos",
        "swiftui"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave2-ios-app": {
      "id": "wave2-ios-app",
      "title": "iOS Companion App",
      "description": "iPhone app with Kanban view, brainstorm input, proposal review, settings",
      "status": "completed",
      "priority": 1,
      "complexity": "large",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T20:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T20:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2 - FlowForgeApp_iOS.swift with full feature set",
      "tags": [
        "wave2",
        "ios",
        "swiftui"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave2-realtime-sync": {
      "id": "wave2-realtime-sync",
      "title": "Real-time Sync",
      "description": "WebSocket for live updates across devices (macOS + iOS)",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T10:00:00.000000",
      "updated_at": "2025-12-24T18:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T18:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2 - WebSocketClient.swift + server.py WebSocket endpoints",
      "tags": [
        "wave2",
        "websocket",
        "sync"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave25-connection-status": {
      "id": "wave25-connection-status",
      "title": "iOS Connection Status UI",
      "description": "Green/red indicator in toolbar, test connection button, error display",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T18:00:00.000000",
      "updated_at": "2025-12-24T20:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T20:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2.5 - ConnectionStatusBadge, testConnection(), iOSSettingsView",
      "tags": [
        "wave25",
        "ios",
        "ux"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave25-tailscale-config": {
      "id": "wave25-tailscale-config",
      "title": "Tailscale Auto-Configuration",
      "description": "Auto-detect Tailscale MagicDNS hostname, persist server URL",
      "status": "completed",
      "priority": 1,
      "complexity": "small",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T19:00:00.000000",
      "updated_at": "2025-12-24T20:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T20:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2.5 - PlatformConfig.swift with Tailscale hostname",
      "tags": [
        "wave25",
        "networking",
        "tailscale"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave25-brainstorm-input": {
      "id": "wave25-brainstorm-input",
      "title": "Brainstorm Input View",
      "description": "TextView for pasting READY_FOR_APPROVAL output, wired to proposal review",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T20:00:00.000000",
      "updated_at": "2025-12-24T21:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T21:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2.5 - BrainstormInputView.swift, replaces placeholder",
      "tags": [
        "wave25",
        "brainstorm",
        "gui"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave25-app-icons": {
      "id": "wave25-app-icons",
      "title": "App Icons with Dark Mode",
      "description": "Light/dark mode icons for macOS (.icns) and iOS (asset catalog)",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T21:00:00.000000",
      "updated_at": "2025-12-24T22:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T22:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 2.5 - AppIcon.icns for macOS, AppIcon.appiconset for iOS",
      "tags": [
        "wave25",
        "design",
        "icons"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave3-blocked-column": {
      "id": "wave3-blocked-column",
      "title": "Blocked Column (5th Status)",
      "description": "Add 'blocked' status to Kanban with red/warning column and block reason field",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:00:00.000000",
      "updated_at": "2025-12-24T23:16:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T23:16:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 3 - Feature.swift blocked status + KanbanView 5th column",
      "tags": [
        "wave3",
        "kanban",
        "status"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave3-keyboard-shortcuts": {
      "id": "wave3-keyboard-shortcuts",
      "title": "Keyboard Shortcuts",
      "description": "Cmd+N new feature, Cmd+R refresh, arrow navigation, Cmd+1-5 column jump",
      "status": "completed",
      "priority": 3,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:00:00.000000",
      "updated_at": "2025-12-24T23:18:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T23:18:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 3 - FlowForgeApp.swift .commands block",
      "tags": [
        "wave3",
        "macos",
        "keyboard"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave3-search-filter": {
      "id": "wave3-search-filter",
      "title": "Search & Filter",
      "description": "Search bar in toolbar, tag filter chips, status filter for Kanban",
      "status": "completed",
      "priority": 4,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:00:00.000000",
      "updated_at": "2025-12-24T23:19:00.000000",
      "started_at": null,
      "completed_at": "2025-12-24T23:19:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 3 - KanbanView search and filter state",
      "tags": [
        "wave3",
        "search",
        "filter"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-max-features": {
      "id": "wave4-max-features",
      "title": "Max 3 Features Constraint",
      "description": "Enforce max 3 planned features to prevent decision paralysis",
      "status": "completed",
      "priority": 1,
      "complexity": "small",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T00:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T00:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.1 - registry.py MAX_PLANNED_FEATURES + GUI slots indicator",
      "tags": [
        "wave4",
        "constraints",
        "shipping-machine"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-scope-creep-detection": {
      "id": "wave4-scope-creep-detection",
      "title": "Scope Creep Detection",
      "description": "AI detects 'and also', 'plus', 'additionally' and suggests smaller scope",
      "status": "completed",
      "priority": 2,
      "complexity": "small",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T00:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T00:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.1 - brainstorm.py check_shippable() + /scope-check endpoint",
      "tags": [
        "wave4",
        "constraints",
        "shipping-machine"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-build-command": {
      "id": "wave4-build-command",
      "title": "forge build Command",
      "description": "One command: idea -> scope check -> worktree -> prompt -> Claude Code",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T00:15:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T00:15:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.2 - cli.py build() combines add + start + prompt copy",
      "tags": [
        "wave4",
        "cli",
        "shipping-machine"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-ship-command": {
      "id": "wave4-ship-command",
      "title": "forge ship Command",
      "description": "One command: merge to main, update streak, celebrate",
      "status": "completed",
      "priority": 2,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [
        "wave4-build-command"
      ],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T00:20:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T00:20:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.2 - cli.py ship() wraps merge + cleanup + streak update",
      "tags": [
        "wave4",
        "cli",
        "shipping-machine"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-shipping-streaks": {
      "id": "wave4-shipping-streaks",
      "title": "Shipping Streak Display",
      "description": "Track current_streak, longest_streak, total_shipped. Show in GUI toolbar.",
      "status": "completed",
      "priority": 1,
      "complexity": "small",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T00:30:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T00:30:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.4 - registry.py ShippingStats + AppState.swift + /shipping-stats endpoint",
      "tags": [
        "wave4",
        "momentum",
        "gamification"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave4-mission-control": {
      "id": "wave4-mission-control",
      "title": "Mission Control Dashboard",
      "description": "Today's Mission, Up Next (2/3), Shipped This Week. Prominent SHIP button.",
      "status": "completed",
      "priority": 2,
      "complexity": "large",
      "parent_id": null,
      "children": [],
      "depends_on": [
        "wave4-shipping-streaks"
      ],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:30:00.000000",
      "updated_at": "2025-12-25T01:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-25T01:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 4.4 - MissionControlView.swift + ContentView toggle",
      "tags": [
        "wave4",
        "gui",
        "shipping-machine"
      ],
      "session_id": null,
      "extensions": {}
    },
    "wave3-pi-deployment": {
      "id": "wave3-pi-deployment",
      "title": "Pi Deployment",
      "description": "Systemd service, deploy script, health check endpoint for 24/7 server",
      "status": "completed",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-24T23:00:00.000000",
      "updated_at": "2025-12-26T12:00:00.000000",
      "started_at": null,
      "completed_at": "2025-12-26T12:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Wave 3 - Deployed to Pi with systemd, Tailscale, offline-first caching",
      "tags": [
        "wave3",
        "devops",
        "pi"
      ],
      "session_id": null,
      "extensions": {}
    },
    "add-hidereveal-for-sidebar-projects": {
      "id": "add-hidereveal-for-sidebar-projects",
      "title": "Sidebar Project Hide/Reveal",
      "description": "Users can hide individual projects from the sidebar to reduce clutter, with a collapsible \"Hidden\" section at the bottom to reveal and restore them. Hidden state persists across app launches.\n\nHow it works:\n- Right-click (macOS) or long-press (iOS) on a project shows context menu with \"Hide Project\" option\n- Hidden projects move to a collapsible \"Hidden (N)\" section at the bottom of the sidebar\n- Clicking the \"Hidden\" section header expands/collapses the list\n- Right-click/long-press on a hidden project shows \"Show Project\" to restore it\n- Hidden project IDs stored in UserDefaults/AppStorage\n- Hidden projects still sync and update in background, just not displayed in main list\n\nFiles likely affected:\n- `FlowForgeApp/Views/Sidebar/ProjectListView.swift` (or equivalent sidebar view)\n- `FlowForgeApp/Models/AppState.swift` (add hiddenProjectIds: Set<String>)\n- `FlowForgeApp/Services/APIClient.swift` (filter hidden from display, not from fetch)\n\nEstimated scope: Small (< 1 hour)",
      "status": "completed",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-26T16:36:07.092701",
      "updated_at": "2025-12-27T13:05:27.138584",
      "started_at": "2025-12-27T12:13:44.609653",
      "completed_at": "2025-12-27T13:17:14.744137",
      "spec_path": null,
      "prompt_path": "/Users/Brian/Projects/Active/FlowForge/.flowforge/prompts/add-hidereveal-for-sidebar-projects.md",
      "notes": null,
      "tags": [],
      "session_id": null,
      "extensions": {}
    },
    "should-move-the-brain-button-and-the-plus-button-s": {
      "id": "should-move-the-brain-button-and-the-plus-button-s",
      "title": "Quick Brainstorm Button (Contextual Idea Generator)",
      "description": "Separates the capture UI into two distinct buttons: a + button for freetext quick capture, and a brain button that generates 3 contextual idea suggestions based on the project's existing features and recent commits. Users tap any suggestion to add it to the inbox instantly.\n\nHow it works:\n- + button opens existing quick capture input (freetext, low friction)\n- Brain button shows a popover with loading state (pulsing brain or skeleton chips)\n- Backend fetches: project name, existing feature titles, last ~15 git commits\n- AI generates 3 short-phrase ideas that don't duplicate existing/completed features\n- Ideas appear as tappable chips in the popover\n- Tapping a chip instantly adds it to inbox as \"idea\" status\n- User can tap brain again for 3 more if nothing resonates (magic 8-ball style)\n- Popover dismisses after selection or tap-outside\n\nFiles likely affected:\n- `FlowForgeApp/Views/VibeInput.swift` (split into + and brain buttons)\n- `flowforge/server.py` (new `/brainstorm/quick` endpoint)\n- `flowforge/intelligence.py` (quick brainstorm prompt generation)\n- `FlowForgeApp/Services/APIClient.swift` (new endpoint call)\n- `FlowForgeApp/Views/Components/BrainstormPopover.swift` (new view)\n\nEstimated scope: Medium (1-3 hours)",
      "status": "idea",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-26T22:23:13.293773",
      "updated_at": "2025-12-28T14:24:44.340599",
      "started_at": "2025-12-27T10:44:31.333809",
      "completed_at": null,
      "spec_path": null,
      "prompt_path": "/Users/Brian/Projects/Active/FlowForge/.flowforge/prompts/should-move-the-brain-button-and-the-plus-button-s.md",
      "tags": [],
      "extensions": {
        "refinement_history": [
          {
            "role": "user",
            "content": "Help me crystallize this idea: should move the brain button and the plus button.  + should be to add a freetext idea and the brain button should generate ?a few? ideas in simple short words from which the user can select any to add to the inbox (bootstrapping creativity)"
          },
          {
            "role": "assistant",
            "content": "I like this idea! You're separating two distinct flows: quick capture (the +) and AI-assisted brainstorming (the brain).\n\nLet me make sure I understand the brain button flow:\n\nWhen the user taps the brain button, the AI generates a few short idea prompts. Then the user can select any (or multiple?) to add to their inbox.\n\n**My first question**: Where do these generated ideas appear? \n\nOptions I'm imagining:\n1. A dropdown/popover near the brain button with the ideas as tappable chips\n2. A modal/sheet that appears with the list\n3. They appear inline in the sidebar somehow\n\nWhich feels right for the UI you're picturing?\n"
          },
          {
            "role": "user",
            "content": "probably a popover but i imagine might take a second to generate ideas so something not too UX breaking?  WHat is a modal/sheet?"
          },
          {
            "role": "assistant",
            "content": "Good instinct on the loading time! A popover works well here - it can show a subtle loading state (maybe a pulsing brain icon or a few skeleton chips) while generating, then smoothly reveal the ideas when ready. Less jarring than a full takeover.\n\nA modal/sheet is like a full-screen or half-screen overlay that demands attention - think the iOS share sheet or a settings panel. For quick idea selection, that's probably overkill. Popover keeps you in flow.\n\n**Next question**: When the AI generates ideas, should they be:\n\n1. **Contextual** - based on the current project's existing features (e.g., if you're working on FlowForge, it might suggest \"batch operations\" or \"keyboard shortcuts for Kanban\")\n2. **Generic/inspirational** - random productivity/feature prompts to spark creativity\n3. **User-configurable** - maybe a blend, or you pick the style?\n\nWhat would help you most when you're stuck and need that creative bootstrap?\n"
          },
          {
            "role": "user",
            "content": "definately contextual, that would be needed for bootstrapping so i suppose thats some complexity but how would you approach"
          },
          {
            "role": "assistant",
            "content": "Smart call - contextual is way more useful for actually getting unstuck.\n\nFor the context, I'd keep it lightweight:\n\n**What to feed the AI:**\n- Project name\n- List of existing feature titles (already in the registry)\n- Maybe the most recent 2-3 features added (shows current focus)\n\nThat's usually enough for the AI to understand the domain and suggest complementary ideas. No need to send full feature specs or code.\n\n**On the backend:**\nThe `/brainstorm` endpoint already exists (used by BrainstormChatView). We could add a simpler `/brainstorm/quick` endpoint that:\n1. Takes project context\n2. Returns 3-5 short phrase ideas (not full specs, just sparks)\n3. Fast prompt, fast response\n\n**Question**: How many ideas feel right? \n\n- 3 ideas = quick to scan, low cognitive load\n- 5 ideas = more options but still digestible\n- Or a \"give me more\" button to generate another batch?\n\nWhat's your gut say?\n"
          },
          {
            "role": "user",
            "content": "prob 3 is fine, can run it arbitrary number of times and is like a magic 8 ball... idk tho can it look at github commits for inspiration and to not overlap?  i suppose the failure mode is duplicating already done work so maybe this would help?"
          },
          {
            "role": "assistant",
            "content": "Love the magic 8-ball vibe - shake it, get 3 ideas, shake again if none hit.\n\nThe GitHub commits idea is clever for avoiding duplicates! Here's my thinking:\n\n**What would actually help:**\n1. **Existing features list** (already planned) - prevents \"add dark mode\" when it's already done\n2. **Recent commit messages** - could show what's been shipped lately so AI doesn't suggest \"add keyboard shortcuts\" when that just landed\n\n**The catch with commits:**\n- Needs git access (already have via worktree code)\n- Commits can be cryptic (\"fix: typo\") vs. feature-level\n- Could grab last ~10-20 commits, let AI parse what's meaningful\n\n**Simpler alternative:**\n- Just compare generated ideas against existing feature titles before showing\n- If AI suggests something too similar to an existing feature, filter it out\n\n**My question**: Is the main concern duplicating *completed* work, or also avoiding overlap with *in-progress* features?\n\nThe registry already tracks feature status (idea/planned/in-progress/completed), so we could be smart about what to exclude.\n"
          },
          {
            "role": "user",
            "content": "i like 10-20 commits and AI parse, existing list feature, there are CLaude generated commit messages so there should be some reasonable english descriptions for most or all commits?  not as worried about duplicating in progress things because the paralellizability is bottlenecked by my brain (which cant do TOO many things at once). make sense?"
          },
          {
            "role": "assistant",
            "content": "Makes total sense! The commit messages being Claude-generated is a nice bonus - they should be descriptive and parseable.\n\nSo the flow is:\n1. User taps brain button\n2. Popover shows with loading state\n3. Backend grabs: project name + existing feature titles + last ~15 commits\n4. AI generates 3 short idea phrases that don't overlap with existing/shipped work\n5. User taps any to add to inbox (as \"idea\" status)\n6. Can tap brain again for 3 more if nothing hits\n\n**One more question**: When the user taps an idea chip to add it, should it:\n\nA) **Instantly add to inbox** with that exact short phrase as the title (fast, magic 8-ball feel)\n\nB) **Pre-fill the quick capture** with that phrase, letting them tweak before adding (more control)\n\nGiven your \"bootstrapping creativity\" framing, I'm guessing A feels right - the whole point is low friction when you're stuck. They can always edit later. But want to confirm!\n"
          },
          {
            "role": "user",
            "content": "well this is pre-crystallization so doesnt need to be too fancy but if we get decent ideas for free (i.e. good ideas are as cheap as bad ideas then great).  The second pass is what we're doing at this very moment in fact!  bootstrapping in action!"
          },
          {
            "role": "assistant",
            "content": "Ha! Yes, exactly - this is literally the second pass in action. Quick capture \u2192 crystallize \u2192 implement. The system working as designed.\n\nAlright, I think we've got enough clarity here. Let me write this up:\n\n---\n\nSPEC_READY\n\nFEATURE: Quick Brainstorm Button (Contextual Idea Generator)\n\nWHAT IT DOES:\nSeparates the capture UI into two distinct buttons: a + button for freetext quick capture, and a brain button that generates 3 contextual idea suggestions based on the project's existing features and recent commits. Users tap any suggestion to add it to the inbox instantly.\n\nHOW IT WORKS:\n- + button opens existing quick capture input (freetext, low friction)\n- Brain button shows a popover with loading state (pulsing brain or skeleton chips)\n- Backend fetches: project name, existing feature titles, last ~15 git commits\n- AI generates 3 short-phrase ideas that don't duplicate existing/completed features\n- Ideas appear as tappable chips in the popover\n- Tapping a chip instantly adds it to inbox as \"idea\" status\n- User can tap brain again for 3 more if nothing resonates (magic 8-ball style)\n- Popover dismisses after selection or tap-outside\n\nFILES LIKELY AFFECTED:\n- `FlowForgeApp/Views/VibeInput.swift` (split into + and brain buttons)\n- `flowforge/server.py` (new `/brainstorm/quick` endpoint)\n- `flowforge/intelligence.py` (quick brainstorm prompt generation)\n- `FlowForgeApp/Services/APIClient.swift` (new endpoint call)\n- `FlowForgeApp/Views/Components/BrainstormPopover.swift` (new view)\n\nESTIMATED SCOPE:\nMedium (1-3 hours)\n"
          },
          {
            "role": "user",
            "content": "I want to narrow the scope of this completely. It should be a feature that only exists on the macOS app for one specific reason. I want to narrow this to just a quick brainstorm button. The brainstorm button would exist somewhere around the area of the idea inbox or around the idea of what do you want to ship. And on hover over, it would expand some text with an animation from that brain icon that says Generate new ideas or generate inspiration or something like that. Yeah, maybe generate new ideas. And it would launch a Claude Code session in the background. So still via our the same, you know, in-app UI, chat UI that we use for refining. No, actually, I don't even know if I want a chat UI. But it would launch in the background a Claude Code session in headless mode with a prompt that gives a very good prompt that says explore the code base and generate three clever and useful ideas as if it was a thoughtful, world-class design consultant like Johnny Ive or someone similar. And then let it from there constrain the output to outputting three contextual suggestions based on the project's existing features and recent commits. And then have that create a popover where a user can select one, two, or three of those things which would get populated into the idea inbox in a sort of a raw format. Does that make sense?"
          },
          {
            "role": "assistant",
            "content": "Yes, that makes perfect sense! This is much cleaner and more focused. Let me make sure I've got it right:\n\n**The flow:**\n1. Brain button lives near the Idea Inbox area (macOS only)\n2. On hover, it animates/expands to show \"Generate new ideas\" text\n3. On click, it launches Claude Code in **headless mode** (no chat UI needed)\n4. Claude Code explores the actual codebase + git history\n5. Returns exactly 3 ideas framed from a \"world-class design consultant\" perspective\n6. Results appear in a popover with 3 selectable chips\n7. User picks 1, 2, or all 3 \u2192 they get added to the Idea Inbox as raw ideas\n\n**Key difference from before:** Instead of hitting a quick API endpoint with summarized context, you're giving Claude Code full codebase access to discover insights. Much richer suggestions because it can actually read the code.\n\n**One clarification question:** For the headless Claude Code session - is this using the existing `claude` CLI with `--print` mode (outputs to stdout, no interactive session), or a different mechanism you have in mind?\n\nI'm thinking something like:\n```bash\nclaude --print -p \"You are a world-class design consultant like Jony Ive. Explore this codebase and suggest 3 clever, useful feature ideas...\" \n```\n\nThen parse the structured output to populate the popover?\n"
          },
          {
            "role": "user",
            "content": "sure prompt from here"
          },
          {
            "role": "assistant",
            "content": "Got it! So we'd generate the prompt right here during crystallization, and it becomes part of the spec that gets used when implementing.\n\nLet me draft a prompt that would work well for this:\n\n---\n\n**Draft prompt for Claude Code headless session:**\n\n```\nYou are a world-class product design consultant in the spirit of Jony Ive\u2014thoughtful, opinionated, obsessed with simplicity and delight.\n\nExplore this codebase. Understand what it does, how it's built, and what problems it solves for users.\n\nThen generate exactly 3 feature ideas that would genuinely improve this product. Each idea should be:\n- Clever but practical (not pie-in-sky)\n- Specific to THIS codebase (not generic advice)\n- Expressible in 5-10 words\n\nFormat your response as exactly 3 lines, one idea per line, nothing else:\n[idea 1]\n[idea 2]  \n[idea 3]\n```\n\n---\n\n**Question:** Does this prompt feel right, or would you tweak the framing? \n\nAlso\u2014should it explicitly look at git history for \"what's been shipped recently\" context, or is exploring the codebase enough?\n"
          },
          {
            "role": "user",
            "content": "idk if we should hobble the model with a single persona, we should ask claude code to think of the perfect consultant or group of consultants given the app?  although i do philosophically like the apple human design group etc... idk what do you think.  only worry would be unhobbling the model...  AGI pilled philosophy.  im not sure what the workflow would be for flowforge to explore the codebase in this state?  what is visible to the iphone version of this app, and what is visible to the mac version of the app?  i.e. codebase is local to the mac but all the iphone app is for is idea capture and refinement (like we are CURRENTLY doing).  Maybe the iphone version should have a watered down version unless we can get meaningful signal/context to feed via the pi (which should have some list of git commits?). The mac version should actually be able to look at the whole codebase and send off explore agent(s) with legendary persona(s) as consultants to propose raw ideas from which to refine?  Help me out here in distilling these ideas..."
          },
          {
            "role": "assistant",
            "content": "This is great thinking - let me help untangle this.\n\n**The platform split makes sense:**\n\n| Platform | What it sees | What it can do |\n|----------|-------------|----------------|\n| **iPhone** | Feature list, git commits (via Pi) | Lightweight: \"Based on recent commits, here are 3 ideas\" |\n| **Mac** | Full codebase locally | Full power: Claude Code explores code, runs agents |\n\n**On the consultant persona question:**\n\nI actually like your instinct to \"unhobble\" - instead of hardcoding Jony Ive, let Claude pick the right lens:\n\n```\nFirst, consider: given what this app does and who it serves, \nwhich legendary designers/thinkers would give the most relevant perspective?\n(e.g., Tufte for data-heavy, Ive for consumer delight, Spolsky for dev tools)\n\nAdopt that mindset, then explore the codebase and suggest 3 ideas.\n```\n\nThis is more AGI-pilled - the model picks its own expert frame based on context.\n\n**Distilling the scope:**\n\nFor THIS feature spec, I'd suggest:\n\n1. **macOS only for v1** - full Claude Code headless exploration with dynamic persona selection\n2. **iPhone gets a simpler version later** - we already have commits on Pi, could do a lightweight `/brainstorm/quick` endpoint that doesn't need codebase access\n\n**Clarifying question:** Should we spec just the macOS version now (Claude Code headless with full codebase access), and leave iPhone as a separate future feature? That keeps this focused and shippable.\n"
          }
        ]
      }
    },
    "context-phase-1-cleanup-done-removed-feature-analy": {
      "id": "context-phase-1-cleanup-done-removed-feature-analy",
      "title": "Context\nPhase 1 cleanup done (removed feature_analyzer.py, expert_router.py).\n\nCurrent problem: Recent commits made ALL operations require Mac via SSH. This breaks the core iOS use case - capturing ideas when MacBook is asleep.\n\nGoal\nRegistry lives on Pi. Git operations still need Mac.\n\nOperation\tWhere it runs\tMac required?\nList features\tPi (local read)\t\u274c\nAdd/update/delete feature\tPi (local write)\t\u274c\nStart feature (worktree)\tMac via SSH\t\u2705\nStop/merge feature\tMac via SSH\t\u2705\nStep 1: Evaluate Existing Code\n[CHANGED] Before writing new code, check if cache.py/sync.py can be repurposed or if simpler is better:\n\n# What do these files actually do?\nhead -60 flowforge/cache.py   # SQLite-based, might be overkill\nhead -60 flowforge/sync.py    # Background sync, conflict resolution\n\nDecision point:\n\nOption A: Repurpose existing cache.py (SQLite) - more robust, already written\nOption B: Simple JSON files on Pi (/var/flowforge/registries/{project}/registry.json) - simpler, matches Mac structure\nRecommend Option B for simplicity - just mirror the Mac's JSON structure on Pi.\n\nStep 2: Add Pi-Local Registry Storage\nConfig (environment variable):\n\nFLOWFORGE_REGISTRY_PATH=/var/flowforge/registries  # Pi-local path\n\nStructure:\n\n/var/flowforge/registries/\n\u251c\u2500\u2500 AirFit/\n\u2502   \u2514\u2500\u2500 registry.json\n\u251c\u2500\u2500 FlowForge/\n\u2502   \u2514\u2500\u2500 registry.json\n\u2514\u2500\u2500 ...\n\nStep 3: Update mcp_server.py\n[CHANGED] These functions currently use SSH for everything. Change to local reads/writes:\n\nFunction\tCurrent\tChange to\n_get_project_context()\tSSH read\tLocal read from Pi\n_add_feature()\tSSH (forge add)\tLocal write to Pi\n_update_feature()\tSSH read/write\tLocal read/write\n_delete_feature()\tSSH read/write\tLocal read/write\n_start_feature()\tSSH\tLocal registry update + SSH for git worktree\n_stop_feature()\tSSH\tLocal registry update + SSH for git commands\n_merge_feature()\tSSH\tLocal registry update + SSH for git merge\nStep 4: Update server.py\n[CHANGED] Remove dead offline-queue logic, but KEEP the Mac-online checks for git operations:\n\nRemove imports (lines 30-31):\n\n# DELETE these - we're replacing with simpler approach\nfrom .cache import CacheManager, get_cache_manager\nfrom .sync import SyncManager, get_sync_manager\n\nRemove sync_manager and cache_manager variables and initialization\n\nSimplify endpoints:\n\nlist_projects: Read local registry, no cache fallback needed\nlist_features: Read local registry\nadd_feature: Write local registry (works offline!)\nstart_feature: Keep Mac-online check (needs git)\nmerge_feature: Keep Mac-online check (needs git)\nRemove /api/{project}/pending - Already done in commit 70b3e76\n\nRemove /api/system/sync - Already done in commit 70b3e76\n\nStep 5: Delete Dead Files\nrm flowforge/cache.py   # 433 lines - replaced by simple JSON\nrm flowforge/sync.py    # 433 lines - no longer needed\n\nStep 6: One-Time Migration\nCopy existing registries from Mac to Pi:\n\n# On Pi, for each project:\nssh $FLOWFORGE_MAC_USER@$FLOWFORGE_MAC_HOST \\\n  \"cat /Users/Brian/Projects/Active/AirFit/.flowforge/registry.json\" \\\n  > /var/flowforge/registries/AirFit/registry.json\n\nStep 7: Sync Strategy (Keep Simple)\nWhen Mac comes online and git operations happen:\n\nAfter start_feature: Pi registry is already updated locally\nAfter merge_feature: Update local registry with result\nNo background sync needed - Pi is source of truth for registry\nEdge case: If someone uses forge CLI directly on Mac, Pi won't know. Accept this limitation or add a \"refresh from Mac\" button later.\n\nTesting\n# Mac CLOSED:\n- Add feature from iPhone \u2192 \u2705 Should work (Pi-local)\n- List features \u2192 \u2705 Should work (Pi-local)\n- Start feature \u2192 \u274c Should fail with \"Mac offline\" message\n\n# Mac OPEN:\n- Start feature \u2192 \u2705 Creates worktree via SSH\n- Stop/Merge \u2192 \u2705 Git ops via SSH\n\nSummary of changes from original prompt:\n\nRemoved already-done items (endpoint deletions)\nAdded decision point: repurpose cache.py vs simple JSON\nClarified that current SSH-only code was wrong direction\nSimplified sync strategy (no background sync, Pi is truth for registry)\nAdded edge case acknowledgment (direct forge CLI usage)",
      "description": null,
      "status": "inbox",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-27T13:06:49.336779",
      "updated_at": "2025-12-27T13:06:49.336785",
      "started_at": null,
      "completed_at": null,
      "spec_path": null,
      "prompt_path": null,
      "notes": null,
      "tags": [],
      "session_id": null,
      "extensions": {}
    },
    "architecture-fixes-api-sync": {
      "id": "architecture-fixes-api-sync",
      "title": "Architecture Fixes: API Discovery, Worktree Cleanup, Registry Sync",
      "description": "Implement 4 fixes from docs/ARCHITECTURE_FIXES.md:\n1. GET /api endpoint for API discoverability\n2. Worktree cleanup on feature delete (in _delete_feature)\n3. POST /api/{project}/cleanup for orphaned worktrees\n4. POST /api/{project}/sync and GET /api/{project}/sync/status for Pi-Mac registry sync",
      "status": "completed",
      "priority": 1,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-29T00:00:00.000000",
      "updated_at": "2025-12-29T00:00:00.000000",
      "started_at": "2025-12-29T00:00:00.000000",
      "completed_at": "2025-12-29T00:00:00.000000",
      "spec_path": null,
      "prompt_path": null,
      "notes": "Files modified: flowforge/server.py, flowforge/mcp_server.py",
      "tags": [
        "backend",
        "api",
        "sync",
        "cleanup"
      ],
      "session_id": null,
      "extensions": {}
    },
    "refine-feature-doesnt-work-in-ios-should-consider-": {
      "id": "refine-feature-doesnt-work-in-ios-should-consider-",
      "title": "Refine feature doesn\u2019t work in iOS. Should consider screen size optimal UI for chat",
      "description": "",
      "status": "idea",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-27T23:51:18.676902",
      "updated_at": "2025-12-27T23:51:18.676912",
      "started_at": null,
      "completed_at": null,
      "spec_path": null,
      "prompt_path": null,
      "tags": [],
      "extensions": {}
    },
    "the-done-button-gives-unclear-outcome": {
      "id": "the-done-button-gives-unclear-outcome",
      "title": "Smart \"Mark as Done\" with Clear Feedback",
      "description": "The \"Mark as Done\" button intelligently detects whether a feature has already been merged to main and either ships it immediately or marks it for review. It shows a loading state during the operation and provides clear feedback about what action was taken.\n\nHow it works:\n- When pressed, show a loading spinner/state on the button\n- Check if the feature's branch has been merged to main (git branch --merged main)\n- If already merged: Clean up worktree, move feature to \"Shipped\", show \"\u2713 Shipped!\" toast\n- If not merged: Move to \"Ready for Review\", show \"Marked for review - merge when ready\" toast\n- If worktree doesn't exist but status is \"building\": Allow manual status advancement with warning\n- Handle server latency gracefully (disable button during operation, show spinner)\n\nFiles likely affected:\n- FlowForgeApp/Views/FeatureRow.swift (button UI, loading state)\n- FlowForgeApp/Services/APIClient.swift (new endpoint or enhanced mark-done logic)\n- flowforge/server.py or flowforge/mcp_server.py (smart merge detection endpoint)\n- flowforge/worktree.py (helper to check if branch merged to main)\n\nEstimated scope: Medium (1-3 hours)",
      "status": "completed",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-28T08:51:49.985125",
      "updated_at": "2025-12-28T16:42:33.839497",
      "started_at": "2025-12-28T08:57:47.039741",
      "completed_at": "2025-12-28T14:30:00.000000",
      "spec_path": null,
      "prompt_path": "/Users/Brian/Projects/Active/FlowForge/.flowforge/prompts/the-done-button-gives-unclear-outcome.md",
      "tags": [],
      "extensions": {
        "refinement_history": [
          {
            "role": "user",
            "content": "Help me refine this idea: the done button gives unclear outcome"
          },
          {
            "role": "assistant",
            "content": "I see you're frustrated with the \"done\" button - that's one of those UI elements that can really break the flow if it's not clear what it does!\n\nLet me make sure I understand the context. Which \"done\" button are you referring to? Is this:\n\n1. The button in the **Brainstorm/Refine chat** (when you're done refining an idea)?\n2. A button on the **Kanban board** (marking a feature as completed)?\n3. Something else in the iOS or macOS app?\n\nOnce I know which button, I can help clarify what outcome you'd expect it to have.\n"
          },
          {
            "role": "user",
            "content": "More specifically the done button. I had a work tree that I was working on with a project and that went through the build status. I think it did a full correct feature input and then I merged everything to main and the status took a second to update after I pressed the mark as done button on a feature that was in the build status, like i.e., I'd gone through a Claude code session. So we should at least give it loading state or something like that when you press the mark as done if there's some latency from the server internet interaction or whatever. But then it says ready for review. I think actually that the Claude code session had already sent through like all of the correct forge commands or whatever, but there's no way for me to clear it from the actively building status. The feature that I'm discussing is within the AirFit project, and it was the Fix the Whisper Kit integration, which we've now successfully done and should be moved to the shipped this week section now that we've done it. But something in that final piece of the workflow is broken. So can you help me troubleshoot that, please?"
          },
          {
            "role": "assistant",
            "content": "Great, this is really helpful context! Let me make sure I understand the issue clearly.\n\nIt sounds like there are actually **two related problems**:\n\n1. **No loading state** on the \"Mark as Done\" button when there's server latency\n2. **The feature got stuck** - you completed the work, merged to main, but the feature stayed in \"building\" status instead of moving to \"shipped\"\n\nLet me ask a clarifying question about the second issue:\n\nWhen you pressed \"Mark as Done\" on the AirFit \"Fix the Whisper Kit integration\" feature, what **did** happen? Did it:\n- Change to \"Ready for Review\" (as you mentioned) and then stop there?\n- Stay stuck in the \"building\" column?\n- Show an error?\n\nAnd a follow-up: After the Claude Code session finished and merged to main, did you run `forge stop <feature-id>` from the terminal, or were you relying entirely on the GUI button?\n\nThis will help me understand whether the issue is:\n- The GUI button not triggering the right backend command\n- The feature lifecycle not advancing correctly (building \u2192 review \u2192 shipped)\n- A sync/display issue where the backend updated but the UI didn't reflect it\n"
          },
          {
            "role": "user",
            "content": "Well, actually, the process of the build to entry into a work tree with a cloud code session to execution of that cloud code session to feature completion did finish. And then I said ship it I did press forge stop and then I didn't enter the feature IDE because that seems a little bit too esoteric for me. So maybe that's important, but I don't think the forge stop command did anything in the cloud code session that I was in. And then I did press the GUI button so that I may have just been relying entirely on the GUI button. But a future cloud code session will have more context than you, so don't need to know specifically about that. I think we're good to go with the prompt from here. That's specifically descriptive."
          },
          {
            "role": "assistant",
            "content": "Got it! So the core issue is that the **\"Mark as Done\" button's outcome is unclear** - it says \"Ready for Review\" but you expected it to ship/complete the feature, and there's no loading state during the server call.\n\nLet me clarify one more thing to nail down the expected behavior:\n\nWhen you press \"Mark as Done\" on a feature that's in the **building** status (with an active worktree), what **should** happen?\n\nOption A: **Just advance status** - Move to \"Ready for Review\", keep the worktree, user runs `forge merge` separately later\n\nOption B: **Full ship** - Merge to main, clean up worktree, move to \"Shipped\" column (all-in-one)\n\nOption C: **Smart behavior** - Detect if already merged to main \u2192 ship it; otherwise \u2192 mark as review\n\nWhich matches your mental model? I'm guessing you want something closer to B or C since you'd already merged in the Claude Code session.\n"
          },
          {
            "role": "user",
            "content": "Option C makes sense. Yeah, option C makes sense. But also, it sounds like we need to review whatever script exists in the project that we're working in and make sure that the claude.md in the project that we're working in is up to date with those commands that help it interact with Forge to show GUI completion events. Is that correct, or am I off base there? If I'm correct, then let's write the prompt."
          },
          {
            "role": "assistant",
            "content": "You're on the right track, but let me clarify the architecture:\n\nThe **Claude Code session inside a worktree** doesn't need special CLAUDE.md instructions to interact with FlowForge - it's the other way around. The **FlowForge GUI and CLI** should detect the state of the git repo (merged to main? branch still exists? worktree active?) and infer the right action.\n\nSo the fix is:\n\n1. **\"Mark as Done\" button gets smarter** (Option C) - detects merge state and either ships or marks for review\n2. **Add loading state** to the button during server calls\n3. **Clearer feedback** - tell the user exactly what happened (\"Merged and shipped!\" vs \"Marked for review - run `forge merge` when ready\")\n\nThe CLAUDE.md in target projects (like AirFit) doesn't need FlowForge-specific instructions because the feature lifecycle is managed externally by FlowForge's registry, not by the project itself.\n\nLet me write this up:\n\n---\n\n```\nSPEC_READY\n\nFEATURE: Smart \"Mark as Done\" with Clear Feedback\n\nWHAT IT DOES:\nThe \"Mark as Done\" button intelligently detects whether a feature has already been merged to main and either ships it immediately or marks it for review. It shows a loading state during the operation and provides clear feedback about what action was taken.\n\nHOW IT WORKS:\n- When pressed, show a loading spinner/state on the button\n- Check if the feature's branch has been merged to main (git branch --merged main)\n- If already merged: Clean up worktree, move feature to \"Shipped\", show \"\u2713 Shipped!\" toast\n- If not merged: Move to \"Ready for Review\", show \"Marked for review - merge when ready\" toast\n- If worktree doesn't exist but status is \"building\": Allow manual status advancement with warning\n- Handle server latency gracefully (disable button during operation, show spinner)\n\nFILES LIKELY AFFECTED:\n- FlowForgeApp/Views/FeatureRow.swift (button UI, loading state)\n- FlowForgeApp/Services/APIClient.swift (new endpoint or enhanced mark-done logic)\n- flowforge/server.py or flowforge/mcp_server.py (smart merge detection endpoint)\n- flowforge/worktree.py (helper to check if branch merged to main)\n\nESTIMATED SCOPE:\nMedium (1-3 hours)\n```\n"
          }
        ]
      }
    },
    "need-to-fix-ios-refine-feature-get-a-pop-up-but-th": {
      "id": "need-to-fix-ios-refine-feature-get-a-pop-up-but-th",
      "title": "Need to fix iOS refine feature.\nGet a pop up but then nothing\u2026\n\nWant feature parity for that with and Mac.",
      "description": "",
      "status": "inbox",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-29T00:35:52.250327",
      "updated_at": "2025-12-29T00:35:52.250337",
      "started_at": null,
      "completed_at": null,
      "spec_path": null,
      "prompt_path": null,
      "tags": [],
      "extensions": {}
    },
    "the-add-button-for-quick-capture-should-auto-dismi": {
      "id": "the-add-button-for-quick-capture-should-auto-dismi",
      "title": "The add button for quick capture should auto dismiss the entry",
      "description": "",
      "status": "inbox",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-29T00:36:31.847117",
      "updated_at": "2025-12-29T00:36:31.847126",
      "started_at": null,
      "completed_at": null,
      "spec_path": null,
      "prompt_path": null,
      "tags": [],
      "extensions": {}
    },
    "should-be-able-to-view-all-idea-statuses-including": {
      "id": "should-be-able-to-view-all-idea-statuses-including",
      "title": "Should be able to view all idea statuses including ideas in progress, building, and completed. Only the raw idea input and ideas in progress would be interactive iPhone just idea incubator basically",
      "description": "",
      "status": "inbox",
      "priority": 5,
      "complexity": "medium",
      "parent_id": null,
      "children": [],
      "depends_on": [],
      "blocked_by": [],
      "branch": null,
      "worktree_path": null,
      "created_at": "2025-12-29T00:38:06.171191",
      "updated_at": "2025-12-29T00:38:06.171201",
      "started_at": null,
      "completed_at": null,
      "spec_path": null,
      "prompt_path": null,
      "tags": [],
      "extensions": {}
    }
  },
  "merge_queue": [],
  "shipping_stats": {
    "current_streak": 1,
    "longest_streak": 1,
    "total_shipped": 24,
    "last_ship_date": "2025-12-25"
  }
}